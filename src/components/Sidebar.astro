---
import { navbarConfig } from '@/config';

import { Icon } from 'astro-icon/components';

import TextButton from './widgets/TextButton.astro';
import IconButton from './widgets/IconButton.astro';
---

<div id="sidebar">
  <div id="sidebar-mask" class="fixed z-40 hidden w-full h-full bg-black/20 backdrop-blur-md backdrop-saturate-100">
  </div>
  <div
    id="sidebar-menu"
    class="md:hidden fixed z-50 -right-1/3 w-1/3 h-full duration-500 border-l-2 border-gray-200 bg-white ease-in-out"
  >
    {
      navbarConfig.navbarCenterItems.map((item) => (
        <TextButton id="nav-menu-item" href={item.href} onclick={item.onclick}>
          <span class="text-xl">{item.text}</span>
        </TextButton>
      ))
    }
    {
      navbarConfig.navbarRightItems.onlyWide.map((item) => (
        <IconButton id="nav-menu-item" href={item.href} onclick={item.onclick} description={item.text}>
          <Icon name={item.icon} class="text-2xl" />
        </IconButton>
      ))
    }
  </div>
</div>

<script>
  const toggleSidebarBtns = document.querySelectorAll('button#toggle-sidebar-btn');
  const sidebarMask = document.getElementById('sidebar-mask');
  const sidebarMenu = document.getElementById('sidebar-menu');

  toggleSidebarBtns.forEach((btn) => {
    btn.addEventListener('click', () => {
      sidebarMask?.classList.toggle('hidden');
      sidebarMenu?.classList.toggle('-translate-x-full');
    });
  });

  sidebarMask?.addEventListener('click', () => {
    sidebarMask?.classList.add('hidden');
    sidebarMenu?.classList.remove('-translate-x-full');
  });

  window.addEventListener('resize', () => {
    if (window.innerWidth > 768) {
      sidebarMask?.classList.add('hidden');
      sidebarMenu?.classList.remove('-translate-x-full');
    }
  });
</script>
