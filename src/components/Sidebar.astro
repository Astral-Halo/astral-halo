---
import { navbarConfig, themeConfig } from '@/config';

import { Icon } from 'astro-icon/components';

import Button from './widgets/Button.astro';
import DarkModeButton from './widgets/DarkModeButton.astro';
---

<div id="sidebar" transition:persist>
  <div
    id="sidebar-mask"
    class="fixed z-40 hidden w-full h-full bg-black/10 backdrop-blur-md backdrop-saturate-100"
  >
  </div>
  <div
    id="sidebar-menu"
    class="fixed md:hidden h-full z-50 -right-1/3 w-1/3 duration-500 ease-in-out border-l-2 border-l-neutral-200 dark:border-l-neutral-800 bg-neutral-50 dark:bg-neutral-950"
  >
    <div id="sidebar-site-data"></div>
    <DarkModeButton showText={true} class="text-lg !w-[calc(100%-1rem)]" />
    <div id="sidebar-menu-text-items">
      {
        navbarConfig.navbarCenterItems.map((item) => (
          <Button
            id="sidebar-menu-item"
            href={item.href}
            onclick={item.onclick}
            title={item.text}
          >
            <span class="text-xl">{item.text}</span>
          </Button>
        ))
      }
    </div>
    <div id="sidebar-menu-icon-items" class="flex">
      {
        navbarConfig.navbarRightItems.onlyWide.map((item) => (
          <Button
            id="sidebar-menu-item"
            href={item.href}
            onclick={item.onclick}
            title={item.text}
          >
            <Icon name={item.icon} class="text-2xl" />
          </Button>
        ))
      }
    </div>
  </div>
</div>

<script>
  const toggleSidebarBtns = document.querySelectorAll('button#toggle-sidebar-btn');
  const sidebarMask = document.getElementById('sidebar-mask');
  const sidebarMenu = document.getElementById('sidebar-menu');

  toggleSidebarBtns.forEach((btn) => {
    btn.addEventListener('click', () => {
      sidebarMask?.classList.toggle('hidden');
      sidebarMenu?.classList.toggle('-translate-x-full');
    });
  });

  sidebarMask?.addEventListener('click', () => {
    sidebarMask?.classList.add('hidden');
    sidebarMenu?.classList.remove('-translate-x-full');
  });

  window.addEventListener('resize', () => {
    if (window.innerWidth > 768) {
      sidebarMask?.classList.add('hidden');
      sidebarMenu?.classList.remove('-translate-x-full');
    }
  });
</script>
