---
import '@/styles/article.scss';
import License from '@components/License.astro';
import ProfileCard from '@components/widgets/ProfileCard.astro';
import TOC from '@components/widgets/TOC.astro';
import GridLayout from '@layouts/GridLayout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const articles = await getCollection('posts');
  return articles.map((article) => ({
    params: { article: article.data.abbrlink },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content, headings } = await render(article);
---

<GridLayout>
  <div class="theme-card-bg theme-border rounded-xl border-2 px-6 py-4">
    <article>
      <Content />
    </article>
    <License time={article.data.published} />
  </div>
  <Fragment slot="aside-fixed">
    <ProfileCard />
  </Fragment>
  <Fragment slot="aside-sticky">
    <TOC headings={headings} />
  </Fragment>
</GridLayout>
